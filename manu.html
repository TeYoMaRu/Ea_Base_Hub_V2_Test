<base target="_top">
<meta charset="UTF-8">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
/* ===== TOP BAR ===== */
.top-bar {
  background: linear-gradient(135deg, #1b5e20, #1b5e20 100%);
  padding: 12px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
}

.brand {
  display: flex;
  align-items: center;
  gap: 10px;
  color: white;
  font-size: 18px;
  font-weight: bold;
  white-space: nowrap;
}

.back-to-menu {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
  color: white;
  text-decoration: none;
  border-radius: 25px;
  font-weight: bold;
  font-size: 14px;
  box-shadow: 0 3px 10px rgba(255,152,0,0.4);
  transition: all 0.3s ease;
}

.back-to-menu:hover {
  background: linear-gradient(135deg, #ffb74d 0%, #ff9800 100%);
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(255,152,0,0.5);
}

.back-to-menu i {
  font-size: 20px;
}

/* ===== NAV MENU ===== */
.nav {
  display: none; /* ซ่อนเป็นค่าเริ่มต้น */
  justify-content: center;
  gap: 40px;
  padding: 20px;
  background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 50%, #a5d6a7 100%);
  flex-wrap: wrap;
}

/* แสดง nav เฉพาะหน้า menu */
.nav.show-nav {
  display: flex
  ;
}

.nav a {
  min-width: 100px;
  max-width: 300px;
  flex: 1;
  padding: 20px 15px;
  border-radius: 16px;
  text-decoration: none;
  color: #2e7d32;
  display: flex;
  flex-direction: column-reverse;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  background: white;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  border: 3px solid transparent;
  text-align: center;
}

.nav a i {
  font-size: 36px;
  margin-bottom: 8px;
}

.nav a span {
  font-size: 14px;
  font-weight: bold;
}

/* ===== ACTIVE STATE ===== */
.nav a.active {
  background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
  color: white;
  border-color: #3f9c00;
  box-shadow: 0 5px 20px rgba(46,125,50,0.4);
  transform: scale(1.05);
}

.nav a.active i {
  color: #e4e002;
}

/* ===== HOVER STATE ===== */
.nav a:not(.active):hover {
  background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
  color: rgb(0, 70, 41);
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

/* ===== BADGE สำหรับบอกว่าอยู่หน้านี้ ===== */
.nav a.active::after {
  display: flex;
  margin-top: 8px;
  font-size: 11px;
  background: #ffeb3b;
  color: #333;
  padding: 3px 10px;
  border-radius: 10px;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .top-bar {
    flex-direction: column;
    gap: 10px;
    text-align: center;
  }

  .nav {
    flex-direction: column;
    align-items: center;
  }

  .nav a {
    width: 90%;
    max-width: 100%;
  }
}

@media print {
  .top-bar, .nav {
    display: none !important;
  }
}

.logo-container {
  display: flex;
  align-items: center;
}

.logo-svg {
  width: 36px;
  height: 36px;
  margin-right: 10px;
}

.logo-svg path {
  fill: white;
}
</style>

<!-- ===== TOP BAR ===== -->
<div class="top-bar">
  <div class="brand">
    <div class="logo-container">
      <svg class="logo-svg" viewBox="0 0 113.39 113.39" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="login-gradient" x1="4.3" y1="46.15" x2="109.09" y2="46.15" gradientUnits="userSpaceOnUse">
            <stop offset="0" stop-color="#4caf50"/>
            <stop offset="1" stop-color="#2e7d32"/>
          </linearGradient>
          <linearGradient id="login-gradient1" x1="28.17" y1="81.92" x2="90.14" y2="81.92" gradientUnits="userSpaceOnUse">
            <stop offset="0" stop-color="#8d6e63"/>
            <stop offset="1" stop-color="#5d4037"/>
          </linearGradient>
        </defs>
        <path class="st1" d="M108.66,55.29c-1.3-1.68-5.05,1.69-5.79-1.16-.31-3.19,3.32-6.6,0-10.42-2.71-1.44-4.82-.39-7.53-1.16-.42-2.28-.83-4.6-2-6.06-2.1-.75-5.49,1.12-6.1-1.47.56-2.25,4.27-1.24,3.67-4.02-3.26-3.06-5.67-3.78-7.75-10.3-.38-1.18-1.05-2.59-2.28-2.75-3.42-.45-4.6-3.42-7.68-6.91-3.63-1.29-4.75.72-7.35.94-1.82-.5-1.92-3.48-4.1-3.6-3.1-.59-2.88,2.14-5.8,1.74-4.34-3.28-8.35-.65-11,2.32-8.11-1.99-13.19,3.8-11,12.16-2.06-.06-2.11-2.14-4.63-1.74-3.69,1.91-2.42,8.77-5.79,11-2.75-.24-4.74.28-6.37,1.16-1.51,2.54-1.9,6.21-1.74,10.42-5.13,1.05-7.84,4.52-11,7.53-.76,5.01,2.63,5.9,3.47,9.27-1.59,1.55-2.03,3.76-1.74,6.95,3.03,1.6,3.41,5.85,5.79,8.11,2.5.38,2.89-1.21,4.63-1.73.96.76.48,1.73,1.74,4.05,4.32-.24,2.44,2.21,4.63,3.47,7.33,4.23,6.54-7.56,10.43-9.85,1.69-.15,1.78,1.31,3.47,1.16,1.4-.73,1.33-2.92,3.48-2.9-.76-.2-1.53-.39-2.32-.58.3-2.67,4.26-.39,5.79-.58-.34-2.56-1.29-4.5-2.9-5.79.97-.07,1.76.29,2.47.89-1.71-1.98-3.84-3.53-7.1-3.21-.09-1.44.3-2.4,1.16-2.9,5.47-1.9,8.51,2.56,10.44,6.37.04-2.6-.31-3.18-.01-5.79.62.11,1.15.31,1.63.56-1-.89-2.09-1.69-3.37-2.3-.42-1.58,1.15-1.17,1.16-2.32,3.72.91,4.68,4.58,8.11,5.79,3.82-.71,5.65-6.2,10.43-4.05-.1.48-.29.86-.56,1.17.62.12.29.57-.02.57-.47,2.2,2.73.74,4.05,1.16-.31.21-.64.41-.97.62,2.37-.79,4.66-.11,5.03,3.44-.07,0-.13,0-.19,0,.25-.01.5-.02.77,0,1.68,1.67-1.57,1.37-1.73,2.9.45,2.06,3.93,1.09,4.05,3.47-1.04-.11-2.15-.27-3.25-.38,3.57,3.04,6.97,6.26,11.36,8.49,2.8-2.01,6.86-2.79,12.16-2.32,2.15.36,2.16,2.85,5.21,2.32,4.39-2.98,9.28-11.29,5.21-17.37.44-2.45,3.22-3.68,1.74-6.37ZM10.2,68.04c.65-3.99,5.21-4.06,5.79-8.11.97-.41,1.53-.17,2.32,0,1.19,2.46,1.12,6.05,1.16,8.68-2.45-.27-7.38,3.03-9.27-.58ZM29.31,43.13c-.8-1.8-1.95-1.72-1.74-3.48.98-8.25,13.33,2.83,1.74,3.48ZM43.21,23.44c-.82-.41-1.13-2.13-.58-3.47,4.03,0,6.83-5.53,9.27-1.16-1.16,3.27-5.9,2.9-8.69,4.63ZM66.96,23.44c-1.65,1.01-5.05,1.9-6.37,0-.6-4.45,6.56-3.24,6.37,0ZM60.01,41.4c0-1.36-1-1.7-.58-3.48,2.74-.53,5.24-1.33,8.11-1.74.78,4.93-3.56,6.85-7.53,5.21ZM82.02,46.03c.46-8.2,13.21-1.3,10.42,4.05-4.13-.7-6.42-3.24-10.42-4.05ZM93.6,70.93c-3.49-1.1-5.87-11.05,1.16-9.85,1.44,2.71,3.1,9.12-1.16,9.85Z"/>
        <path class="st0" d="M28.17,103.93c3.95-5.72,10.51-1.4,15.64-2.9,2.26-.66,5.16-4.07,5.79-6.95.91-4.1,1.14-12.4,0-16.22-1.3-4.36-6.19-5.65-11.58-6.95.3-2.67,4.26-.39,5.79-.58-.34-2.56-1.29-4.5-2.9-5.79,4.38-.32,5.11,8.02,10.42,8.69,3.71-3.04-1.64-5.74-3.47-6.95.1-3.11-.32-3.58,0-6.37,4.25.76,4.7,5.34,8.11,6.95,3.94-1.85,4.61-6.97,9.27-8.11.65.11.32.58,0,.58-.47,2.2,2.73.74,4.05,1.16-2.89,1.93-6.54,3.11-6.94,7.53.1.47.58.58.58,1.16,5.22,0,5.54-4.88,11-4.63,1.68,1.67-1.57,1.37-1.73,2.9.45,2.06,3.93,1.09,4.05,3.47-3.57-.37-7.93-1.4-9.85,1.16-.98,14.36-1.68,27.76,10.42,30.12,4.26.83,10.16-1.49,13.32,2.89H29.9s-1.34,0-1.73-1.16Z"/>
      </svg>
    </div>
    <span>บริษัท เอิร์นนี่ แอดวานซ์</span>
  </div>
  
  <a class="back-to-menu" href="<?= ScriptApp.getService().getUrl() ?>?page=menu">
    <i class="material-icons">home</i>
    <span>กลับหน้าเมนูหลัก</span>
  </a>
</div>

<!-- ===== NAV MENU - แสดงเฉพาะหน้า menu ===== -->
<div class="nav" id="navMenu">
  <a class="nav-form1" href="<?= ScriptApp.getService().getUrl() ?>?page=form1">
    <i class="material-icons">assignment</i>
    <span>แผนการเดินทาง<br>และเบิกทดลองจ่าย ๑</span>
  </a>

  <a class="nav-form2" href="<?= ScriptApp.getService().getUrl() ?>?page=form2">
    <i class="material-icons">receipt_long</i>
    <span>ใบเดินทางจริง<br>และเคลียค่าใช้จ่าย ๒</span>
  </a>
  
</div>

<script>
(function() {
  var currentPage = "<?= typeof page !== 'undefined' ? page : '' ?>";
  
  if (!currentPage) {
    var url = window.location.href;
    var match = url.match(/[?&]page=([^&]*)/);
    if (match && match[1]) {
      currentPage = match[1];
    }
  }

  var navMenu = document.getElementById('navMenu');
  
  // แสดง nav menu เฉพาะหน้า menu เท่านั้น
  if (currentPage === 'menu' || currentPage === '') {
    navMenu.classList.add('show-nav');
  }

  // เพิ่ม active class
  if (currentPage === 'form1' || currentPage === 'report_form1') {
    var form1Link = document.querySelector('.nav-form1');
    if(form1Link) form1Link.classList.add('active');
  } 
  else if (currentPage === 'form2' || currentPage === 'report_form2') {
    var form2Link = document.querySelector('.nav-form2');
    if(form2Link) form2Link.classList.add('active');
  }
})();
</script>